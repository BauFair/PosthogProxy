{
	# If Coolify terminates TLS in front and speaks plain HTTP to this container:
	# auto_https off
}

hi.baufer.beauty {
	route {
		# Static SDK assets (PostHog recommends the region assets domain)
		handle_path /ingest/static/* {
			reverse_proxy https://us-assets.i.posthog.com {
				header_up Host us-assets.i.posthog.com
				header_down -Access-Control-Allow-Origin
			}
		}

		# Everything else (event capture, decide, etc.)
		handle_path /ingest/* {
			reverse_proxy https://us.i.posthog.com {
				header_up Host us.i.posthog.com
				header_down -Access-Control-Allow-Origin
			}
		}

		# Fallback only if nothing above matched
		handle {
			respond "Analytics proxy running" 200
		}
	}
}
